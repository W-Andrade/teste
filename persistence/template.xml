<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="template">

    <insert id="add">
        insert 
        into template
        (prod_name,prod_desc)
        values
        (#{prodName},#{prodDesc})
    </insert>
	
    <update id="update">
        update 
        template
        set
        template_name = #{templateName}
        ,template_desc = #{templateDesc}
    </update>
	
    <delete id="delete">
        delete
        from template
        where
        template_id = #{templateId}
    </delete>
	
    <select id="find" resultMap="template">
        select
        *
        from
        template
        where
        template_id = #{templateId}
    </select>
	
    <!-- Very Complex Result Map -->
    <resultMap id="template" type="Map">
        <constructor>
            <idArg column="blog_id" javaType="int"/>
        </constructor>
        <result property="title" column="blog_title"/>
        <association property="author" javaType="Author">
            <id property="id" column="author_id"/>
            <result property="username" column="author_username"/>
            <result property="password" column="author_password"/>
            <result property="email" column="author_email"/>
            <result property="bio" column="author_bio"/>
            <result property="favouriteSection" column="author_favourite_section"/>
        </association>
        <collection property="posts" ofType="Map">
            <id property="id" column="post_id"/>
            <result property="subject" column="post_subject"/>
            <association property="author" javaType="Author"/>
            <collection property="comments" ofType="Comment">
                <id property="id" column="comment_id"/>
            </collection>
            <collection property="tags" ofType="Tag" >
                <id property="id" column="tag_id"/>
            </collection>
            <discriminator javaType="int" column="draft">
                <case value="1" resultType="DraftPost"/>
            </discriminator>
        </collection>
    </resultMap>

</mapper>
